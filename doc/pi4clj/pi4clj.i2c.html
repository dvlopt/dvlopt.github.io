<!DOCTYPE html PUBLIC ""
    "">
<html><head><meta charset="UTF-8" /><link href="css/default.css" rel="stylesheet" type="text/css" /><script src="js/jquery.min.js" type="text/javascript"></script><script src="js/page_effects.js" type="text/javascript"></script><title>pi4clj.i2c documentation</title></head><body><div id="header"><h2>Generated by <a href="https://github.com/weavejester/codox">Codox</a></h2><h1><a href="index.html"><span class="project-title"><span class="project-name">Pi4clj</span> <span class="project-version">0.0.0-alpha0</span></span></a></h1></div><div class="sidebar primary"><h3 class="no-link"><span class="inner">Project</span></h3><ul class="index-link"><li class="depth-1 "><a href="index.html"><div class="inner">Index</div></a></li></ul><h3 class="no-link"><span class="inner">Namespaces</span></h3><ul><li class="depth-1"><div class="no-link"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>pi4clj</span></div></div></li><li class="depth-2 branch"><a href="pi4clj.gpio.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>gpio</span></div></a></li><li class="depth-2 current"><a href="pi4clj.i2c.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>i2c</span></div></a></li></ul></div><div class="sidebar secondary"><h3><a href="#top"><span class="inner">Public Vars</span></a></h3><ul><li class="depth-1"><a href="pi4clj.i2c.html#var-II2CBus"><div class="inner"><span>II2CBus</span></div></a></li><li class="depth-2 branch"><a href="pi4clj.i2c.html#var-close-bus.21"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>close-bus!</span></div></a></li><li class="depth-2 branch"><a href="pi4clj.i2c.html#var-read.21"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>read!</span></div></a></li><li class="depth-2 branch"><a href="pi4clj.i2c.html#var-write.21"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>write!</span></div></a></li><li class="depth-2"><a href="pi4clj.i2c.html#var-writes.21"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>writes!</span></div></a></li><li class="depth-1"><a href="pi4clj.i2c.html#var-open-bus.21"><div class="inner"><span>open-bus!</span></div></a></li></ul></div><div class="namespace-docs" id="content"><h1 class="anchor" id="top">pi4clj.i2c</h1><div class="doc"><pre class="plaintext">Everything related to I2C

'open-bus' opens a I2C bus at the given file path.

The resulting object implements II2CBus and can be used
for reads and writes to slave devices.

Don't forget to 'close-bus!' buses that aren't used
anymore.</pre></div><div class="public anchor" id="var-II2CBus"><h3>II2CBus</h3><h4 class="type">protocol</h4><div class="usage"></div><div class="doc"><pre class="plaintext">Functions for handling I2C buses returned by 'pi4clj.i2c/open-bus!'.

Each bus has its own agent in order to order operations in sequence (most notably
reads and writes). II2CBus functions typically send a function to the agent and return
a promise that will be delivered after the sent function is executed.</pre></div><div class="members"><h4>members</h4><div class="inner"><div class="public anchor" id="var-close-bus.21"><h3>close-bus!</h3><div class="usage"><code>(close-bus! this)</code></div><div class="doc"><pre class="plaintext">Close this bus. From now on, reads and writes will be disabled
and will return nil instead of a promise.

Pending reads and writes will still be executed.

Returns a promise that will be delivered when the device file is closed.</pre></div></div><div class="public anchor" id="var-read.21"><h3>read!</h3><div class="usage"><code>(read! this slave-address n)</code><code>(read! this slave-address register n)</code></div><div class="doc"><pre class="plaintext">Read 'n' bytes from a i2c slave at the register (if given).

Returns * a promise that will be set to * resulting coll of bytes if reading succeeded
                                        * nil                     if reading failed
        * nil if the bus is closed

;; bus defined as 'i2c-1'
;; reads 2 bytes from slave 0x48 at register 0xaa

@(pi4clj.i2c/read! i2c-1 0x48 0xaa 2)</pre></div></div><div class="public anchor" id="var-write.21"><h3>write!</h3><div class="usage"><code>(write! this slave-address data)</code><code>(write! this slave-address register data)</code></div><div class="doc"><pre class="plaintext">Write a single byte or a collection of bytes at once to a i2c slave at the register (if given).

Returns * a promise that will set to * true  if writing succeeded
                                     * false if writing failed
        * nil if the bus is closed


;; bus defined as 'i2c-1'
;; writes 2 bytes at once to slave 0x48 at register 0x10

@(pi4clj.i2c/write! i2c-1 0x48 0x10 [0xac 0x0c])</pre></div></div><div class="public anchor" id="var-writes.21"><h3>writes!</h3><div class="usage"><code>(writes! this slave-address data)</code><code>(writes! this slave-address register data)</code></div><div class="doc"><pre class="plaintext">Succesively writes bytes to a i2c slave at the register (if given).

Facilitates such things as configuration and basically any operations requiring
a sequence of distinct writes.

Returns * true if all writes succeeded
        * the byte or coll of bytes that failed the sequence
        * nil if the bus is closed


;; bus defined as 'i2c-1'
;; configure slave 0x48

(pi4clj.i2c/writes! i2c-1 0x48 [0x22         ;; stop slave
                                [0xac 0x0c]  ;; 2 bytes config
                                0x51])       ;; restart slave</pre></div></div></div></div><div class="src-link"><a href="https://github.com/dvlopt/pi4clj/blob/0.0.0-alpha0/src/pi4clj/i2c.clj#L18">view source</a></div></div><div class="public anchor" id="var-open-bus.21"><h3>open-bus!</h3><div class="usage"><code>(open-bus! bus-path)</code></div><div class="doc"><pre class="plaintext">Open a I2C bus at the given file path.

Returns * an object implementing II2CBus if opening succeeded
        * nil                            if opening failed


(def i2c-1 (pi4clj.i2c/open-bus! "/dev/i2c-1"))</pre></div><div class="src-link"><a href="https://github.com/dvlopt/pi4clj/blob/0.0.0-alpha0/src/pi4clj/i2c.clj#L116">view source</a></div></div></div></body></html>